<p-drawer [visible]="userRoleService.isShowForm()" (visibleChange)="onVisibleChange($event)" position="right" styleClass="max-w-[750px] !w-[100%] !md:w-full" [header]="headerTitle">
    <form [formGroup]="form" (ngSubmit)="submit()" class="py-3 space-y-6">
        <p-floatlabel variant="in" class="!w-full">
            <input pInputText id="key" formControlName="key" class="w-full" autocomplete="off" [invalid]="isInvalid('key')" />
            <label for="key">Key (*)</label>
        </p-floatlabel>

        <p-floatlabel variant="in" class="!w-full">
            <input pInputText id="name" formControlName="name" class="w-full" autocomplete="off" [invalid]="isInvalid('name')" />
            <label for="name">Tên quyền hạn (*)</label>
        </p-floatlabel>

        <p-floatlabel variant="in">
            <textarea pTextarea id="description" formControlName="description" rows="4" class="h-full w-full"></textarea>
            <label for="description">Mô tả</label>
        </p-floatlabel>
        <div class="relative">
           <p-picklist
            [source]="sourcePermissions"
            [target]="targetPermissions"
            [dragdrop]="false"
            [responsive]="true"
            filterBy="name"
            sourceFilterPlaceholder="Search by name"
            targetFilterPlaceholder="Search by name"
            breakpoint="750px"
            scrollHeight="15rem"
            dataKey="id"
            (onMoveToTarget)="onMoveToTarget($event)"
            (onMoveToSource)="onMoveToSource($event)"
            (onMoveAllToTarget)="onMoveAllToTarget($event)"
            (onMoveAllToSource)="onMoveAllToSource($event)"
        >
            <ng-template let-option let-selected="selected">
                <div class="p-1">
                    <span class="font-medium text-sm">{{ option.name }}</span>
                </div>
            </ng-template>
        </p-picklist>

        @if(loading){
          <div class="absolute inset-0 flex items-center justify-center w-full h-full bg-gray-100/50">
            <i class="pi pi-spinner-dotted !text-3xl animate-spin"></i>
        </div>
        }

        </div>

    </form>

    <ng-template #footer>
        <button (click)="submit()"
        [disabled]="loading"
         class="rounded-md w-full py-2 border border-primary text-primary hover:bg-primary hover:text-white">
            <i class="pi mr-3" [ngClass]="userRoleService.isEditMode()? 'pi-pen-to-square':'pi-plus-circle' "></i>
            @if (userRoleService.isEditMode()) { Cập nhật ngay } @else { Thêm mới }
        </button>
    </ng-template>
</p-drawer>
